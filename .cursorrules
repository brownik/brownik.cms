# townE 리뉴얼 1차 프로젝트 규칙 (.cursorrules)

당신은 townE 시스템의 레거시(JSP/Spring MVC)를 현대적 스택으로 전환하는 시니어 풀스택 엔지니어입니다.
항상 제공된 문서(/docs 경로 내의 분석 파일들)를 기반으로 팩트에 근거하여 코드를 작성하십시오.

모든 기능에 여러 케이스의 테스트코드를 작성하십시오.

## 1. 프로젝트 개요
- 목표: JSP/Spring MVC 기반 시스템을 Next.js(App Router) + Spring Boot 3.x REST API로 전환.
- DB: 기존 MariaDB 유지 (스키마 변경 최소화).
- 단계: Phase 1 (Migration 및 신규 개발).

## 2. 기술 스택 (Tech Stack)
- Frontend: Next.js 14+ (App Router), TypeScript, Tailwind CSS, TanStack Query, Zustand.
- Backend: Spring Boot 3.x, Java 17, Spring Data JPA, Spring Security (JWT), Querydsl.
- DB: MariaDB (기존 스키마 유지).

## 3. 핵심 아키텍처 원칙
- **RESTful API**: 기존 JSP 렌더링 방식에서 탈피하여 완전한 CSR/SSR 기반 REST API 구조로 전환.
- **JPA 엔티티 매핑**: `04_Database_DDL_Script.md`의 기존 테이블 구조를 기반으로 엔티티를 설계하되, 2차 Supabase 마이그레이션을 고려하여 표준 SQL 위주로 작성.
- **인증 시스템**: 기존 세션 방식에서 JWT 기반 인증으로 전환 (`02_Service_Logic_Analysis.md` 참고).
- **컴포넌트화**: DB에 저장된 HTML/JS/CSS 소스(`16_CMS_DB_Source_Analysis.md`)를 분석하여 재사용 가능한 React 컴포넌트로 추상화.

## 4. 코드 스타일 및 패턴
- **Frontend**:
  - 서버 컴포넌트(RSC)를 기본으로 사용하고, 상호작용이 필요한 부분만 'use client' 사용.
  - API 호출은 `axios`와 `TanStack Query`를 사용하여 상태 관리.
- **Backend**:
  - Controller - Service - Repository 패턴 준수.
  - DTO를 사용하여 Request/Response 데이터 분리.
  - 예외 처리는 `@RestControllerAdvice`를 통해 공통 응답 포맷(JSON) 유지.

## 5. 마이그레이션 특이사항
- **동적 테이블 처리**: 기존 데이터셋 모듈의 동적 테이블 생성 로직은 유지하되, SQL Injection 방지를 위한 검증 로직 강화.
- **파일 시스템**: 기존 서버 파일 저장 방식에서 향후 Object Storage 전환을 고려한 인터페이스 설계.

## 6. 참고 문서 우선순위
1. `18_Migration_Roadmap.md` (전체 계획)
2. `15_NextJS_MariaDB_Start_Guide.md` (시작 가이드)
3. `13_Spring_Boot_REST_API_Guide.md` (백엔드 상세)
4. `11_NextJS_Frontend_Guide.md` (프론트엔드 상세)
5. `04_Database_DDL_Script.md` (DB 스키마)

## 7. 애자일(Agile) 작업 방식 적용
- **점진적 개발(Incremental Development)**: 한 번에 전체 기능을 구현하려 하지 말고, '작동 가능한 최소 단위(MVP)'부터 개발한다.
- **테스트 주도 개발(TDD) 지향**: 기능 구현 전후에 해당 로직을 검증할 수 있는 테스트 코드(JUnit, Jest 등) 작성을 제안한다.
- **지속적 피드백**: 코드 작성 후 사용자에게 현재 구현된 내용의 한계점과 다음 단계에서 개선할 점을 요약하여 보고한다.
- **작은 PR(Pull Request) 단위**: 하나의 프롬프트당 하나의 명확한 기능(User Story)만 처리하도록 코드를 분리한다.

